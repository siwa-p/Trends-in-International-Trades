{{ config(
    materialized='table',
    on_schema_change = 'ignore',
    format='iceberg',
    schema='silver',
    partition_by=['bucket(32, CTY_NAME)', 'IMPORT_YEAR']
) }}
select
    CASE WHEN NULLIF(CTY_CODE, '-') IS NOT NULL THEN CAST(CTY_CODE AS INT) ELSE NULL END AS CTY_CODE,
    CTY_NAME,
    CASE WHEN NULLIF(DISTRICT, '-') IS NOT NULL THEN CAST(DISTRICT AS INT) ELSE NULL END AS DISTRICT,
    DIST_NAME,
    CAST(GEN_VAL_YR AS DOUBLE) AS GEN_VAL_YR,
    CAST(AIR_VAL_YR AS DOUBLE) AS AIR_VAL_YR,
    CAST(AIR_WGT_YR AS DOUBLE) AS AIR_WGT_YR,
    CAST(I_COMMODITY AS INT) AS I_COMMODITY,
    I_COMMODITY_SDESC,
    CAST(GEN_VAL_MO AS DOUBLE) AS GEN_VAL_MO,
    CAST(AIR_VAL_MO AS DOUBLE) AS AIR_VAL_MO,
    CAST(AIR_WGT_MO AS DOUBLE) AS AIR_WGT_MO,
    CAST(VES_VAL_MO AS DOUBLE) AS VES_VAL_MO,
    CAST(VES_WGT_MO AS DOUBLE) AS VES_WGT_MO,
    SUMMARY_LVL,
    COMM_LVL,
    CAST("YEAR" AS INT) AS IMPORT_YEAR,
    CAST("MONTH" AS INT) AS IMPORT_MONTH,
    CC_MO,
    CC_YR,
    CNT_VAL_MO,
    CNT_VAL_YR,
    CNT_WGT_MO,
    CNT_WGT_YR,
    LAST_UPDATE,
    GEN_QY1_MO,
    GEN_QY1_MO_FLAG,
    GEN_QY1_YR,
    GEN_QY1_YR_FLAG,
    GEN_QY2_MO,
    GEN_QY2_MO_FLAG,
    GEN_QY2_YR,
    GEN_QY2_YR_FLAG,
    UNIT_QY1,
    UNIT_QY2,
    VES_VAL_YR,
    VES_WGT_YR
from "wits-data".import_hs